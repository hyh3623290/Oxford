# ES2015

â€‹	let åªä¼šåœ¨å½“å‰ä»£ç å—ä¸­ç”Ÿæ•ˆï¼Œæ‰€ä»¥å¯ä»¥è§£å†³å¾ªç¯çš„é—®é¢˜

â€‹	å¾ªç¯ä¸­æ‹¬å·æ˜¯ä¸€ä¸ªæ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼Œå—å†…éƒ¨æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼Œå¯ä»¥è¿™ä¹ˆç†è§£

## åŸºæœ¬

```js
// æ•°ç»„è§£æ„
const [, , a] = arr
const [a = 2, ...foo] = arr

// å¯¹è±¡è§£æ„
const { name: newname = 'foo' } = obj

// æ¨¡æ¿å­—ç¬¦ä¸²
function tag(strings, name) {}
const result = tag`123` // å¸¦æ ‡ç­¾å‡½æ•°

// includesï¼ˆæ•°ç»„ä¹Ÿæœ‰ï¼‰ï¼ŒstartsWithï¼ŒendsWith

// å‚æ•°é»˜è®¤å€¼
function foo(baz, bar = '123') { 
  é»˜è®¤å€¼å‚æ•°è¦æ”¾åœ¨æœ€åï¼Œä¸ç„¶ä¼šå‡ºé”™
}

// å‰©ä½™å‚æ•°
function foo(...args) {}

// ç®­å¤´å‡½æ•°é‡Œæ²¡æœ‰thisçš„æœºåˆ¶ï¼Œæ‰€ä»¥å®ƒä¸ä¼šæ”¹å˜thisçš„æŒ‡å‘
// ç®­å¤´å‡½æ•°å¤–é¢çš„thisæ˜¯ä»€ä¹ˆï¼Œå°±æ˜¯ä»€ä¹ˆï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜
const person = {
  name: 'tom',
  sayNameAsync: function() {
    setTimeout(function() {
      console.log(this.name)
    }, 1000)
  }
}
person.sayNameAsync() // undefined

// Object.assign
å°†å¤šä¸ªå¯¹è±¡çš„å±æ€§å¤åˆ¶åˆ°ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸­

// Object.is
ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œ
+0 === -0 è¿”å›true
NaN == NaN è¿”å›false
è€Œä½¿ç”¨Object.isæ­£å¥½ç›¸å

// Math.pow(2, 10)
2çš„10æ¬¡æ–¹
```



## Proxy

â€‹	ä»£ç†å¯¹è±¡

â€‹	å¦‚æœæˆ‘ä»¬æƒ³è¦ç›‘è§†æŸä¸ªå¯¹è±¡çš„å±æ€§çš„è¯»å†™ï¼Œå¯ä»¥ä½¿ç”¨`Object.defineProperty`æ·»åŠ å±æ€§ï¼Œä»è€Œæ•è·åˆ°å¯¹è±¡ä¸­çš„å±æ€§è¯»å†™è¿‡ç¨‹ã€‚Proxyæ˜¯ä¸ºå¯¹è±¡ä¸“é—¨æä¾›çš„ä¸€ä¸ªè®¿é—®ä»£ç†å™¨çš„ï¼Œå¯ä»¥è½»æ¾çš„ç›‘è§†åˆ°å¯¹è±¡è¯»å†™è¿‡ç¨‹

```js
const person = {
  name: 'John',
  age: 20
}

const personProxy = new Proxy(person, {
  get(target, property) {
    return 100
    return property in target ? target[property] : 'default'
  },
  set(target, property, value) {
    if(property === 'age') {
      if(!Number.isInteger(value)) {
        throw new TypeError('balabala')
      }
      target[property] = value
    }
  },
  // æ›´å¤šé¢å¤–æ“ä½œ
  deleteProperty(target, property) { },
})

console.log(personProxy.name) // 100
```

- Proxyæ›´ä¸ºå¼ºå¤§ï¼Œèƒ½ç›‘å¬åˆ°æ›´å¤šå¯¹è±¡æ“ä½œï¼Œè€ŒdefinePropertyåªèƒ½ç›‘å¬åˆ°å¯¹è±¡çš„è¯»å†™ã€‚

  ä¾‹å¦‚deleteï¼Œæˆ–è€…å¯¹å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨

- æ›´å¥½çš„æ”¯æŒæ•°ç»„å¯¹è±¡çš„ç›‘è§†

- ä»¥éä¾µå…¥çš„æ–¹å¼ç›‘ç®¡äº†å¯¹è±¡çš„è¯»å†™ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå·²ç»å®šä¹‰å¥½çš„å¯¹è±¡æˆ‘ä»¬ä¸éœ€è¦å¯¹å¯¹è±¡æœ¬èº«å»åšä»»ä½•çš„æ“ä½œå°±å¯ä»¥ç›‘è§†åˆ°å®ƒå†…éƒ¨æˆå‘˜çš„è¯»å†™ï¼Œè€Œè¦æ±‚æˆ‘ä»¬å¿…é¡»è¦é€šè¿‡ç‰¹å®šçš„æ–¹å¼å•ç‹¬å»å®šä¹‰å¯¹è±¡å½“ä¸­ä¸€äº›éœ€è¦è¢«ç›‘è§†çš„å±æ€§ï¼Œå°±æ˜¯éœ€è¦åšå¾ˆå¤šé¢å¤–çš„æ“ä½œï¼Œå¦‚æ•°ç»„æ–¹æ³•

## Reflect

â€‹	é™æ€ç±»ï¼Œä¸èƒ½newæ¥å®ä¾‹åŒ–ï¼Œåªèƒ½ä½¿ç”¨ä¸€äº›é™æ€ç±»çš„é™æ€æ–¹æ³•ï¼š`Reflect.get()`ï¼Œå¦‚Mathã€‚å®ƒå°è£…äº†ä¸€ç³»åˆ—å¯¹å¯¹è±¡çš„åº•å±‚æ“ä½œã€‚æœ‰13ä¸ªæ–¹æ³•ï¼Œå’ŒProxyçš„æ–¹æ³•ä¸€æ ·ã€‚å…¶å®çš„è¯ï¼ŒProxyé‡Œé¢é»˜è®¤å°±æ˜¯è°ƒç”¨äº†Reflectçš„æ–¹æ³•ï¼Œæ¯”å¦‚æ²¡æœ‰è‡ªå·±å†™getæ–¹æ³•çš„è¯é»˜è®¤å°±æ˜¯è¿”å›Reflectçš„getæ–¹æ³•ã€‚

â€‹	ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸ªï¼Œä»·å€¼åœ¨å“ªï¼šç»Ÿä¸€æä¾›äº†ä¸€å¥—ç”¨äºæ“ä½œå¯¹è±¡çš„API

```js
'name' in obj
delete obj['age']
Object.keys(obj)
// å¦‚ä¸Šï¼Œå¤ªä¹±ï¼Œä¸å¤Ÿç»Ÿä¸€

Reflect.has(obj, 'name')
Reflect.deleteProperty(obj, 'age')
Reflect.ownKeys(obj)
```



## class

```js
class Person {
  constructor(name) {
    this.name = name
    console.log(Person.c())
  }
  say() {}
  static create(name) {
    return new Person(name)
  }
  static c() {
    return 666
  }
}

class Student extends Person {
  constructor(name, id) {
    super(name)
    this.id = id
  }
  hello() {
    super.say()
    ...
  }
}

const p = new Person('tom')
p.say()
const p = Person.create('tom')

```

- å®ä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡å®ä¾‹æ¥è°ƒç”¨å’Œé€šè¿‡ç±»æ¥è°ƒç”¨
- extendsä»¥åstudentå°±æ‹¥æœ‰Personçš„æ‰€æœ‰çš„æˆå‘˜äº†
- superå§‹ç»ˆæŒ‡å‘çˆ¶ç±»ï¼Œsuper(name)è°ƒç”¨å®ƒå°±æ˜¯è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°



## Set

â€‹	é›†åˆï¼Œä¸æ•°ç»„éå¸¸ç±»ä¼¼ï¼Œä½†ä¸å…è®¸é‡å¤

```js
const s = new Set()

s.add(1).add(2)
s.delete(100) // æˆåŠŸè¿”å›true
s.clear()
s.has(100)
s.forEach(i => console.log(i))
for(let i of s)
s.size()


```

`for of` å¯éå†æ•°ç»„	`[...new Set(arr)]` å¯ä»¥å»é‡



## Map

â€‹	ç±»ä¼¼å¯¹è±¡ï¼Œå¥å€¼å¯¹é›†åˆï¼Œæ™®é€šå¯¹è±¡çš„å¥åªèƒ½æ˜¯å­—ç¬¦ä¸²

```js
const m = new Map()

const tom = { name: 'tom' }
m.set(tom, 90) // ä»¥å¯¹è±¡ä½œä¸ºkey
m.delete(tom)
m.clear()
m.get(tom)
m.forEach((value, key) => console.log(value, key))
```



## Symbol

â€‹	å¯¹è±¡å±æ€§éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œå­—ç¬¦ä¸²æ˜¯æœ‰å¯èƒ½é‡å¤çš„ã€‚ç°å¦‚ä»Šæˆ‘ä»¬å¤§é‡ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦å»æ‹“å±•ç¬¬ä¸‰æ–¹æ¨¡å—ä¸­æä¾›çš„ä¸€äº›å¯¹è±¡ï¼Œé‚£æ­¤æ—¶ä½ æ˜¯ä¸çŸ¥é“è¿™ä¸ªå¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªæŒ‡å®šçš„å¥ï¼Œå¦‚æœç›´æ¥å»å†’ç„¶çš„æ‹“å±•ï¼Œå°±æœ‰å¯èƒ½ä¼šäº§ç”Ÿå†²çªçš„é—®é¢˜ã€‚ç›®å‰å®ƒå°±æ˜¯ä¸ºäº†ä¸ºå¯¹è±¡åˆ›å»ºä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ç¬¦

```js
typeof s // symbol
Symbol() === Symbol() // false

obj[Symbol()] = '123'
```

â€‹	å¦å¤–æˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ©è¿™ä¸ªå±æ€§çš„ç‰¹ç‚¹æ¨¡æ‹Ÿå®ç°å¯¹è±¡çš„ç§æœ‰æˆå‘˜é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠæ³•å»åˆ›å»ºä¸€ä¸ªå®Œå…¨ç›¸åŒçš„symbolï¼Œäºæ˜¯æˆ‘ä»¬ä¸èƒ½è®¿é—®åˆ°è¿™ä¸ªæˆå‘˜

```js
const name = new Symbol()
const person = {
  [name]: 'tom',
  say() { this[name] }
}
person(new Symbol()) // undefined
```

â€‹	ç›®å‰ä¸€å…±7ç§æ•°æ®ç±»å‹ï¼Œæœªæ¥è¿˜ä¼šåŠ ä¸€ä¸ªBigIntæ•°æ®ç±»å‹

â€‹	å¦‚æœæƒ³è¦è·å–ç›¸åŒçš„Symbolæ€ä¹ˆåŠï¼Œ

```js
const s1 = Symbol.for('foo')
const s2 = Symbol.for('foo')
s1 === s2 // true
```

â€‹	è¦æ³¨æ„çš„æ˜¯å¦‚ä¸‹æ–¹å¼éƒ½è·å–ä¸åˆ°Symbolå¯¹è±¡çš„å±æ€§

```js
for(var key in obj)
Object.keys(obj)
JSON.stringify(obj)

åŠæ³•æ˜¯ Object.getOwnPropertySymbols(obj)
```



## éå†

```js
for // æ•°ç»„
for in // å¥å€¼å¯¹

// å…¨æ–°çš„æ–¹å¼ for of éå†æ‰€æœ‰çš„æ•°æ®ç»“æ„çš„ç»Ÿä¸€æ–¹å¼ æ•°ç»„ï¼Œä¼ªæ•°ç»„ï¼Œsetï¼Œmapï¼Œå¯¹è±¡
const map = new Map()
map.set('foo', '123')
for (const item of map) {
  item æ˜¯ ['foo', '123']
}
```

1. for of å¯ä»¥ç”¨breakç»ˆæ­¢å¾ªç¯ï¼ŒforEachä¸å¯ä»¥ï¼Œéå†æ•°ç»„ç±»çš„è¯æ¯ä¸ªitemå°±æ˜¯æ¯ä¸ªå€¼
2. `for( const [key, value] of map)` å€ŸåŠ©è§£æ„æ–¹ä¾¿çš„æ‹¿åˆ°mapçš„å€¼



## Iterator

â€‹	å¯è¿­ä»£å¯¹è±¡ï¼Œæˆ‘ä»¬å‘ç°for of åªèƒ½éå†æ•°ç»„ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œä¸ºäº†ç»™å„ä¸ªæ•°æ®ç»“æ„æä¾›ä¸€ç§ç»Ÿä¸€çš„éå†æ–¹å¼ï¼Œå°±æœ‰äº†Iteratoræ¥å£ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨for ofçš„å‰æã€‚æˆ‘ä»¬å‘ç°æ‰€æœ‰ç±»æ•°ç»„çš„å¯¹è±¡çš„`__proto__`ä¸Šéƒ½æœ‰`Symbol(Symbol.Iterator)`è¿™ä¸ªå±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨è¯•ä¸€ä¸‹

```js
arr[Symbol.iterator]() // Array Iterator {} æ•°ç»„çš„è¿­ä»£å™¨å¯¹è±¡
```

â€‹	å±•å¼€è¿™ä¸ªå¯¹è±¡åå‘ç°å®ƒæœ‰ä¸€ä¸ªnextæ–¹æ³•

```js
const iterator = arr[Symbol.iterator]()
iterator.next() // { value: 'foo', done: false }
```

â€‹	æ­¤æ—¶å°±èƒ½å¤Ÿæƒ³åˆ°è¿™ä¸ªè¿­ä»£å™¨å†…éƒ¨åº”è¯¥ç»´æŠ¤äº†ä¸€ä¸ªæ•°æ®æŒ‡é’ˆï¼Œæ¯è°ƒç”¨ä¸€æ¬¡nextï¼ŒæŒ‡é’ˆä¾¿å¾€åç§»ä¸€ä½

ğŸ‡ éå†å¯¹è±¡

```js
const obj = {
  store: ['foo', 'bar', 'baz'],
  [Symbol.iterator]: function() { // å®ç°å¯è¿­ä»£æ¥å£ Iterable Symbol.iterator
    let index = 0
    const self = this
    return {
      next: function() { // å®ç°è¿­ä»£å™¨æ¥å£ Iterator next
        const result = { // è¿­ä»£ç»“æœæ¥å£ IterationResult
          value: self.store[index],
          done: index++ >= self.store.length
        }
        return result
      }
    }
  }
}
```

â€‹	è¿™ä¸ªæ„ä¹‰åœ¨å“ªå‘¢ï¼Œäº‹å®ä¸Šè¿™ä¸ªå°±æ˜¯è¿­ä»£å™¨æ¨¡å¼ã€‚

â€‹	å‡å®šæˆ‘ä»¬ç°åœ¨æ­£åœ¨ååŒå¼€å‘ä¸€ä¸ªä»»åŠ¡æ¸…å•åº”ç”¨ï¼Œæˆ‘çš„ä»»åŠ¡æ˜¯è®¾è®¡ä¸€ä¸ªç”¨äºå­˜æ”¾æ‰€æœ‰ä»»åŠ¡çš„å¯¹è±¡ï¼Œæˆ‘ä¸ºäº†å¯ä»¥æ›´æœ‰ç»“æ„çš„å»è®°å½•æ¯ä¸€ä¸ªæ•°æ®ï¼Œè®¾è®¡ä¸€ä¸ªå¯¹è±¡ç»“æ„ã€‚ä½ çš„ä»»åŠ¡æ˜¯æŠŠæˆ‘å®šä¹‰çš„è¿™ä¸ªå¯¹è±¡å½“ä¸­æ‰€æœ‰çš„ä»»åŠ¡é¡¹ç½—åˆ—å‘ˆç°åˆ°ç•Œé¢ä¸Šï¼Œæ­¤æ—¶ï¼Œå¯¹äºä½ è€Œè¨€ï¼Œä½ å°±å¿…é¡»è¦äº†è§£è¿™ä¸ªå¯¹è±¡çš„æ•°æ®ç»“æ„æ‰è¡Œï¼Œä½ å¯ä»¥åˆ†åˆ«éå†æˆ‘çš„lifeå’Œlearnï¼Œé‚£å¦‚æœçªç„¶æˆ‘çš„æ•°æ®ç»“æ„å˜åŒ–äº†ï¼Œé‚£ä½ è¿˜å¾—ä¿®æ”¹ä»£ç ã€‚æ‰€ä»¥å¦‚æœæˆ‘èƒ½æä¾›ä¸€ä¸ªç»Ÿä¸€çš„éå†æ¥å£ï¼Œé‚£ä½ å°±ä¸ç”¨å…³å¿ƒæˆ‘å¯¹è±¡å†…éƒ¨çš„ç»“æ„ï¼Œæ›´ä¸ç”¨æ‹…å¿ƒæˆ‘çš„ç»“æ„æ”¹å˜äº§ç”Ÿçš„å½±å“

```js
// æˆ‘çš„ä»£ç 
const todos = {
  life: ['a', 'b', 'c'],
  learn: ['d', 'e', 'f'],
  [Symbol.iterator]: function() {
    const all = [...this.life, ...this.learn]
    let index = 0
    return {
      next: function() {
        return {
          value: all[index],
          done: index++ >= all.length
        }
      }
    }
  }  
}

// ä½ çš„ä»£ç 
for (const item of todos) {
  console.log(item)
}
```





## ES2017

```js
// Object.values(obj)
è¿”å›å¯¹è±¡çš„valueï¼Œè·ŸObject.keyså¾ˆç±»ä¼¼

// Object.entries(obj)
å°†å¯¹è±¡è½¬ä¸ºæ•°ç»„å½¢å¼ [['foo','1'], ['bar','1']]

for(const [key, value] of Object.entries(obj))
  
new Map(Object.entries(obj))

// padEnd padStart
name.padEnd(5, '-') => 'tom--'
name.padStart(5, '-') => '--tom'
```



## å¼‚æ­¥

â€‹	JavaScriptä¸ºä»€ä¹ˆå•çº¿ç¨‹ï¼šå‡è®¾ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªä¿®æ”¹äº†domï¼Œä¸€ä¸ªåˆ é™¤äº†dom...

â€‹	é¦–å…ˆè¯´åŒæ­¥ï¼ŒJSæœ‰ä¸ªè°ƒç”¨æ ˆçš„æ¦‚å¿µï¼šé¦–å…ˆJSå¼•æ“ä¼šå°†æ•´ä½“çš„ä»£ç éƒ½åŠ è½½è¿›æ¥ï¼Œç„¶ååœ¨è°ƒç”¨æ ˆä¸­åŠ è½½ä¸€ä¸ªåŒ¿åçš„è°ƒç”¨ï¼ˆç›¸å½“äºæŠŠå…¨å±€ä»£ç æ”¾åˆ°ä¸€ä¸ªåŒ¿åå‡½æ•°å»æ‰§è¡Œï¼‰ï¼Œç„¶åå¦‚ä¸‹ï¼š

1. å°†ç¬¬ä¸€æ¡è¯­å¥å‹å…¥è°ƒç”¨æ ˆä¸­ï¼Œå¹¶æ‰§è¡Œï¼Œæ‰§è¡Œå®Œå¼¹å‡ºè°ƒç”¨æ ˆ
2. å°†ç¬¬äºŒæ¡è¯­å¥å‹å…¥è°ƒç”¨æ ˆ...
3. é‡å¤...ï¼ˆå‡½æ•°å£°æ˜ä¸ä¼šäº§ç”Ÿä»»ä½•è°ƒç”¨ï¼Œæ‰€ä»¥å…ˆè·³è¿‡ï¼‰

### Event Loop

â€‹	å¼‚æ­¥ä»»åŠ¡ä¼šè¢«æ”¾è¿›æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå½“è°ƒç”¨æ ˆçš„ä»£ç ä¸ºç©ºæ—¶ï¼Œevent loopå°±ä¼šä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ”¾å…¥è°ƒç”¨æ ˆä¸­ã€‚æ‰€ä»¥å®ƒå°±åšä¸€ä»¶äº‹æƒ…ï¼Œç›‘å¬è°ƒç”¨æ ˆå’Œæ¶ˆæ¯é˜Ÿåˆ—ã€‚

ğŸ‡ æ‰§è¡Œæ—¶åº / å®ä»»åŠ¡ & å¾®ä»»åŠ¡

â€‹	å›è°ƒé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æˆä¸ºå®ä»»åŠ¡ï¼Œå®ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šåŠ ä¸Šä¸€äº›é¢å¤–çš„éœ€æ±‚ï¼Œå¯ä»¥é€‰æ‹©ä½œä¸ºä¸€ä¸ªæ–°çš„å®ä»»åŠ¡è¿›åˆ°é˜Ÿåˆ—ä¸­è¿›è¡Œæ’é˜Ÿï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½œä¸ºå½“å‰ä»»åŠ¡çš„å¾®ä»»åŠ¡ï¼Œç›´æ¥åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œè¿‡åç«‹å³æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç­‰åˆ°æœ«å°¾ç»§ç»­æ’é˜Ÿã€‚Promiseçš„å›è°ƒä¼šä½œä¸ºå¾®ä»»åŠ¡æ‰§è¡Œã€‚å¾®ä»»åŠ¡å°±æ˜¯åé¢æ‰æå‡ºçš„ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†æé«˜æ•´ä½“çš„å“åº”èƒ½åŠ›

â€‹	æ‰“ä¸ªæ¯”æ–¹ï¼Œæˆ‘åŠå­˜æ¬¾ä¸šåŠ¡æ’é˜Ÿï¼ŒåŠå®Œä¹‹åçªç„¶æƒ³åŠä¸ªä¿¡ç”¨å¡ï¼Œåˆ™ä¸éœ€è¦é‡æ–°æ’é˜Ÿå»å–å·ã€‚

â€‹	å¸¸ç”¨å¾®ä»»åŠ¡ï¼špromiseï¼ŒMutationObserverï¼Œprocess.nextTickï¼ˆNodeï¼‰ï¼Œasyncï¼Œawait

â€‹	å…¶ä½™å¤§éƒ¨åˆ†å¼‚æ­¥éƒ½æ˜¯å®ä»»åŠ¡

â€‹	è¡¥å……ï¼ševentloopï¼šè°ƒç”¨æ ˆï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚å¾®ä»»åŠ¡é˜Ÿåˆ—ä¼šåœ¨è°ƒç”¨æ ˆæƒ…ç©ºæ—¶ç«‹å³æ‰§è¡Œï¼Œå¹¶ä¸”å¤„ç†æœŸé—´æ–°åŠ å…¥çš„å¾®ä»»åŠ¡ä¹Ÿä¼šä¸€åŒæ‰§è¡Œ



### promise

â€‹	promiseåµŒå¥—ä½¿ç”¨æ˜¯å…¶å¸¸è§çš„è¯¯åŒºï¼Œè¿™æ ·å†™ä¾æ—§ä¼šé™·å…¥å›è°ƒåœ°ç‹±ï¼Œè¿˜ä¸å¦‚å›è°ƒçš„æ–¹å¼ï¼Œæ‰€ä»¥åº”ä½¿ç”¨é“¾å¼

```js
// åµŒå¥—
promise.then(res => {
  promise2.then(res => {
    ...
  })
})
  
// é“¾å¼
promise
  .then(res => {
  	...
	})
  .then(res => {
  	...
	})
  .catch(err => { 
  	... 
	})


// catchç›¸å½“äºå¦‚ä¸‹
.then(undefined, err => {
  ...
})
å’Œåœ¨thené‡Œæ”¾ç¬¬äºŒä¸ªå‡½æ•°æ•ˆæœæ˜¯ä¸€æ ·çš„
ä¸è¿‡catchå¯ä»¥æ•è·åˆ°å®ƒä¹‹å‰çš„thené‡Œå¼‚å¸¸ï¼Œè€Œthené‡Œçš„ç¬¬äºŒä¸ªå‚æ•°ä¸èƒ½æ•è·åˆ°ç¬¬ä¸€ä¸ªå‚æ•°çš„å¼‚å¸¸
å› ä¸ºé”™è¯¯ä¼šä¸€ç›´å‘åä¼ é€’çš„ï¼Œç›´åˆ°è¢«æ•è·
```

- æ¯ä¸ª`then`å³æ˜¯ä¸€ä¸ªå…¨æ–°çš„`promise .then() === new Promise()`
- `then`åªè¦è¿”å›äº†ï¼ˆå³ä½¿æ˜¯è¿”å›`new Error`ï¼‰ï¼Œå°±ç›¸å½“äº`resolved`ï¼Œä¼šä¼ ç»™ç¬¬äºŒä¸ª`then`ï¼Œæ²¡æœ‰è¿”å›å³æ˜¯é»˜è®¤`undefined`ã€‚é™¤éæŠ¥é”™ï¼Œå¦‚`throw new Error`ï¼Œå°±ä¼šèµ°åé¢çš„thençš„ç¬¬äºŒä¸ªå‚æ•°ã€‚å³ç›¸å½“äºreject

ğŸ‡ é™æ€æ–¹æ³•

â€‹	`Promise.resolve()`å¿«é€ŸæŠŠä¸€ä¸ªå€¼è½¬æ¢ä¸ºpromiseå¯¹è±¡ã€‚å¦‚æœåŸæ¥å°±æ˜¯promiseï¼Œåˆ™ä¼šåŸæ ·è¿”å›ï¼Œå¯ä»¥è¯•ä¸€ä¸‹ä¸¤ä¸ªç”¨ä¸‰ç­‰ç¬¦å·ï¼Œè¿”å›çš„å°±æ˜¯trueã€‚åŒç†æœ‰`Promise.reject()`

```js
Promise.resolve({
  then: (resolved, reject) => {
    resolved(1)
  }
})
.then(v => {
  console(v)
})
// è¿™æ ·å®ç°ä¸€ä¸ªthenä¹Ÿæ˜¯å¯ä»¥çš„
// ä¿—ç§°å®ç°thenableæ¥å£
```

ğŸ‡ å¹¶è¡Œ

```js
// all
Promise.all([
  ajax1('url'),
  ajax2('url')
])
.then()

// race åŒç†
// æ¡ˆä¾‹ï¼šajaxè¯·æ±‚è¶…æ—¶å¼‚å¸¸çš„æ§åˆ¶
var request = ajax('url')
var timeout = new Promise(() => { setTimeout })

Promise.race([request, timeout])

```





### ç”Ÿæˆå™¨

â€‹	Generatorï¼Œé¿å…å¼‚æ­¥å›è°ƒåµŒå¥—å¤ªæ·±

```js
const *foo() {
  console.log('1')
  return 2
}
const result = foo()
console.log(result) // ç”Ÿæˆå™¨å¯¹è±¡
console.log(result.next()) // '1' { value: 2, done: true }
```

â€‹	ä½ å‘ç°è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯å¾—åˆ°ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œåªæœ‰nextä¹‹åå‡½æ•°ä½“æ‰å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°yieldåœä¸‹å¹¶ä¼šä½œä¸ºvalueã€‚æœ€å¤§çš„ç‰¹ç‚¹æ˜¯æƒ°æ€§æ‰§è¡Œï¼Œå°±æ˜¯æŠ½ä¸€ä¸‹åŠ¨ä¸€ä¸‹

ğŸ‡ **åº”ç”¨**

```js
const todos = {
  life: ['a', 'b', 'c'],
  learn: ['d', 'e', 'f'],
  [Symbol.iterator]: function *() {
    const all = [...this.life, ...this.learn]
		for(const item of all) { // è‡ªåŠ¨ç”Ÿæˆè¿­ä»£å™¨æ¥å£
      yield item
    }
  }  
}
```

ğŸ‡ **å¼‚æ­¥æ–¹æ¡ˆ**

```js
function *main() {
  try {
    const users = yield ajax('url')
    console.log(users)
    const goods = yield ajax('url2')
    console.log(goods)    
  } catch(e) {
    ...
  }
}

const g = main()
const result = generator.next()
result.value.then(res => {
  const result2 = g.next(res)
  result2.value.then(res => {
    g.next(res)
  })
})

// æ›´é€šç”¨ -> é€’å½’
function handleResult(result) {
  if(result.done) return
  result.value.then(res => {
    handleResult(g.next(res))
  }, error => {
    g.throw(error)
  })
}
handleResult(g.next())
// æ¥ä¸‹æ¥ç¨å¾®å°è£…ä¸€ä¸‹ï¼Œç›®å‰ç¤¾åŒºå·²æœ‰æ›´å®Œå–„çš„åº“ï¼Œå°±æ˜¯co
```



### async await

â€‹	asyncå‡½æ•°è¿”å›å€¼ä¹Ÿæ˜¯promise









